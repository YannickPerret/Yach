<!DOCTYPE html>
<html>
  <head>
    <title>Yach - <%= title %></title>
  </head>
<body>

<button id="createNewCalendar">Create new Calendar</button>

<form action="/api/v1/calendar" method="post" enctype="multipart/form-data">
  <h2>Create a new Calendar</h2>
  <label>Upload calendar : </label><input type="file" name="file" id="file" /><br>
  <label>Calendar type : </label>
  <select name="type">
    <option value="PERSONAL">Personal</option>
    <option value="PROFESSIONAL">Professional</option>
    <option value="OTHER">Other</option>
  </select><br>
  <label>Calendar name : </label><input type="text" name="name" id="name" /><br>

  <h2>Select your calendars :</h2>
  <% if (calendars.length === 0) { %>
    <p>Don't have calendars available</p>
  <% } else { %>
    <h3>Epistec team</h3>
    <% calendars.forEach(function(calendar) { %>
        <% if (calendar.type == 'PERSONAL') { %>
          <input type="checkbox" id="<%= calendar.id %>" name="calendars" value="<%= calendar.id %>">
          <label for="<%= calendar.id %>"><%= calendar.name %></label><br>
        <% } %>
    <% }); %>

    <h3>Epsitec calendar</h3>
    <% calendars.forEach(function(calendar) { %>
        <% if (calendar.type == 'PROFESSIONAL') { %>
          <input type="checkbox" id="<%= calendar.id %>" name="calendars" value="<%= calendar.id %>">
          <label for="<%= calendar.id %>"><%= calendar.name %></label><br>
        <% } %>
    <% }); %>
  <% } %>

  <h3>Shared Calendars (Only check here)</h3>
  <% calendars.forEach(function(calendar) { %>
    <% if (calendar.type == 'SHARED') { %>
      <input type="checkbox" id="<%= calendar.id %>" name="calendars" value="<%= calendar.id %>">
      <label for="<%= calendar.id %>"><%= calendar.name %></label><br>
    <% } %>
  <% }); %>
  <br />
  <input type="submit" value="Submit">
</form>

</body>

<script>
  document.getElementById('createNewCalendar').addEventListener('click', function() {
    // Assurez-vous de définir l'URL et les données correctement
    const url = 'http://localhost:3000/api/v1/calendar/new';
    const data = {
      // Vos données ici (par exemple, le nom du calendrier, le type, etc.)

    };

    fetch(url, {
      method: 'MKCALENDAR',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
    })
    .then(response => response.json())
    .then(data => {
      console.log(data);
      // Gérez la réponse ici (par exemple, rafraîchissez la page, montrez un message, etc.)
    })
    .catch(error => {
      console.error('There was an error!', error);
    });
  });
</script>
</html>
